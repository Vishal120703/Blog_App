<%- include('element/header')%>
<%- include('element/navbar')%>
<div class="container py-5">
  <div class="card shadow-lg p-4 mx-auto" style="max-width: 750px;">
    <h2 class="text-center mb-4 text-primary">Create a New Blog Post</h2>

    <% if (typeof errorMessage !== 'undefined' && errorMessage) { %>
      <div class="alert alert-danger alert-dismissible fade show" role="alert">
        <%= errorMessage %>
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
      </div>
    <% } %>

    <form action="/user/dashboard/post" method="POST" enctype="multipart/form-data">
      
      <!-- Title -->
      <div class="mb-3">
        <label for="title" class="form-label">Title</label>
        <input 
          type="text" 
          class="form-control" 
          id="title" 
          name="title" 
          placeholder="Enter blog title"
          required>
      </div>

      <!-- Category -->
      <div class="mb-3">
        <label for="category" class="form-label">Category</label>
        <select class="form-select" id="category" name="category" required>
          <option value="">Select category</option>
          <option value="Technology">Technology</option>
          <option value="Lifestyle">Lifestyle</option>
          <option value="Education">Education</option>
          <option value="Health">Health</option>
          <option value="Travel">Travel</option>
          <option value="Other">Other</option>
        </select>
      </div>

      <!-- Image -->
      <div class="mb-3">
        <label for="image" class="form-label">Cover Image</label>
        <input 
          type="file" 
          class="form-control" 
          id="image" 
          name="image" 
          accept="image/jpeg,image/jpg,image/png,image/gif,image/webp,image/avif"
          onchange="previewImage(this)">
        <small class="form-text text-muted">Max file size: 5MB. Allowed formats: JPEG, PNG, GIF, WebP, AVIF</small>
        <div id="imagePreview" class="mt-3" style="display: none;">
          <img id="previewImg" src="" alt="Preview" class="img-fluid rounded" style="max-height: 300px; border: 1px solid #ddd;">
          <button type="button" class="btn btn-sm btn-danger mt-2" onclick="clearImagePreview()">Remove Image</button>
        </div>
      </div>

      <!-- Excerpt -->
      <div class="mb-3">
        <label for="excerpt" class="form-label">Excerpt (Optional)</label>
        <textarea 
          class="form-control" 
          id="excerpt" 
          name="excerpt" 
          rows="3" 
          placeholder="A short description of your post (will be used in previews)"
          maxlength="300"></textarea>
        <small class="form-text text-muted">Brief summary of your post (max 300 characters)</small>
      </div>

      <!-- Content -->
      <div class="mb-3">
        <label for="content" class="form-label">Blog Content</label>
        <textarea 
          class="form-control" 
          id="content" 
          name="content" 
          rows="10" 
          placeholder="Write your blog content here..."
          required></textarea>
      </div>

      <!-- Submit Button -->
      <button type="submit" class="btn btn-success w-100">Publish Blog</button>
    </form>
  </div>
</div>

<script>
function previewImage(input) {
    const preview = document.getElementById('imagePreview');
    const previewImg = document.getElementById('previewImg');
    
    if (input.files && input.files[0]) {
        const reader = new FileReader();
        
        reader.onload = function(e) {
            previewImg.src = e.target.result;
            preview.style.display = 'block';
        }
        
        reader.readAsDataURL(input.files[0]);
    }
}

function clearImagePreview() {
    document.getElementById('image').value = '';
    document.getElementById('imagePreview').style.display = 'none';
    document.getElementById('previewImg').src = '';
}
</script>

<%- include('element/footer')%>